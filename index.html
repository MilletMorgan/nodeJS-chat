<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Chat socket.io</title>
</head>
<body>
    <h1>Chat</h1>

    <form action="/" method="post" id="form_chat">
        <input type="text" name="message" id="message" placeholder="Votre message..." size="50" autofocus />
        <input type="submit" id="envoi_message" value="Envoyer" />
    </form>

    <section id="zone_chat">

    </section>

    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io.connect('http://localhost:8080');
        const pseudo = prompt("Quel est votre pseudo ?");
        socket.emit('new', pseudo);

        socket.on('message', function(data) {
            insereMessage(data.pseudo, data.message)
        });

        socket.on('new', function(pseudo) {
            $('#zone_chat').prepend('<p><em>' + pseudo + ' a rejoint le Chat !</em></p>');
        });

        $('#form_chat').submit(function () {
            const message = $('#message').val();
            socket.emit('message', message);

            insereMessage(pseudo, message);

            $('#message').val('').focus();

            return false;
        });

        function insereMessage(pseudo, message) {
            $('#zone_chat').prepend(pseudo + ' : ' + message + '<br/>');
        }
    </script>
</body>
</html>